[
  {
    "query_id": "54f3415d-72c0-4c02-9312-5f951a42d185",
    "query": "What were the highest, lowest, and closing prices for Apple stock on 2023-04-15?",
    "sql": "select t1.ACDATE,t1.code,t1.HIGH,t1.LOW,t1.CLOSE\n  from SRCIFF.TB_FTS_DAILYPRICEINFO_US t1\n  where t1.acdate='2023-04-15'\n  and t1.CODE='AAPL'",
    "tool_name": "get_highest_lowest_close_prices_by_date_stock_number",
    "parameters": {
      "stock_code": "AAPL",
      "acdate": "2023-04-15"
    },
    "tool_description": "查詢在xx日期，美股xxxx股票號的最高價、最低價及收市價\n\nReturns:\n    str: The query result"
  },
  {
    "query_id": "a112f0d6-e97f-4a2b-9e8e-80479e44b0b2",
    "query": "What was the technical pattern for Google stock on 2023-05-10?",
    "sql": "select distinct t1.ACDATE,t1.code,t1.PATTERN_ID,t1.PATTERN_NAME\n  from SRCIFF.TB_FTS_DAILYCHARTPATTERN t1\n  where t1.acdate='2023-05-10'\n  and t1.confirmed_date<='2023-05-10'\n  and t1.expiry_date>'2023-05-10'\n  and t1.CODE='GOOG'\n  and t1.pattern_ID in (5,6,7,8,13,14,26,27,30,31,32,34,35,36,41,42,43,44,45,46,50,51,60,61,62,63,70,71)",
    "tool_name": "get_technical_type_by_date_stock",
    "parameters": {
      "stock_code": "GOOG",
      "acdate": "2023-05-10"
    },
    "tool_description": "查詢在xx日期，某個xxxx股票號的技術形態\n\nReturns:\n    str: The query result"
  },
  {
    "query_id": "6c3adcca-7cda-49c6-8f73-9ca542dc1180",
    "query": "What is the P/E ratio forecast for 中國銀行 on 2023-06-01?",
    "sql": "select t1.DATE,t1.code,1/nullifzero(t1.earning_yld_estimate) as estimated_PE ,t3.STOCK_NAME,t3.CHI_NAME\n  from SRCIFF.TB_FTS_DAILYCOMPINFO t1 left\n  join srciff.TB_DW46SK1 t3 on t3.acdate=t1.acdate\n  and t3.stock_code=t1.code\n  where t1.acdate='2023-06-01'\n  and t3.CHI_NAME like ''",
    "tool_name": "get_stock_premium",
    "parameters": {
      "company_name": "",
      "acdate": "2023-06-01"
    },
    "tool_description": "查詢在xx日期，某個xx股票(公司名)的預測市盈率\n\nReturns:\n    str: The query result"
  },
  {
    "query_id": "b10056fe-42e8-4dfb-9fe9-71859c2ccbd4",
    "query": "What are the top 5 stocks by earnings yield in the HSI on 2023-03-15?",
    "sql": "select t1.DATE,t1.INDEX_CODE,t1.STOCK_CODE,t1.WEIGHT ,t2.EARNING_YLD_ESTIMATE ,t3.STOCK_NAME,t3.CHI_NAME\n  from SRCIFF.TB_FTS_DAILYINDEXCONSTITUENT t1 left\n  join SRCIFF.TB_FTS_DAILYCOMPINFO t2 on t2.acdate=t1.acdate\n  and t2.date=t1.date\n  and t2.code=t1.stock_code left\n  join srciff.TB_DW46SK1 t3 on t3.acdate=t1.acdate\n  and t3.stock_code=t1.stock_code\n  where t1.acdate='2023-03-15'\n  and t1.index_code='HSI'\n  order by t2.EARNING_YLD_ESTIMATE desc\n  limit '5'",
    "tool_name": "get_top_stocks_by_date_and_weight",
    "parameters": {
      "index_code": "HSI",
      "number": "5",
      "acdate": "2023-03-15"
    },
    "tool_description": "查詢在xx日期，xx指數成分股預測收益率最高的n只股票\n\nReturns:\n    str: The query result"
  },
  {
    "query_id": "ab89bd8d-828f-48ee-b929-f62af72f375c",
    "query": "How many banking stocks are in the HSI index as of 2023-02-20 and what's their total weight?",
    "sql": "select t1.DATE,t1.INDEX_CODE ,count(t1.STOCK_CODE) as number_of_stock ,sum(t1.WEIGHT) as total_percent\n  from SRCIFF.TB_FTS_DAILYINDEXCONSTITUENT t1 left\n  join SRCIFF.TB_FTS_DAILYCOMPINFO t2 on t2.acdate=t1.acdate\n  and t2.date=t1.date\n  and t2.code=t1.stock_code\n  where t1.acdate='2023-02-20'\n  and t1.index_code='HSI'\n  and (t2.industry='null'\n  or t2.industry='null')\n  group by t1.DATE,t1.INDEX_CODE",
    "tool_name": "get_stock_holding_by_date_industry_ratio",
    "parameters": {
      "industry_code": "null",
      "index_code": "HSI",
      "acdate": "2023-02-20"
    },
    "tool_description": "查詢在xx日期，xx行業在xx指數有多少隻股票，以及比重\n\nReturns:\n    str: The query result"
  },
  {
    "query_id": "96f0ce0e-15bd-48bf-84fb-45111215acd7",
    "query": "Which stock performed worst in the HSI index on 2023-01-15?",
    "sql": "select t1.DATE,t1.INDEX_CODE ,t1.STOCK_CODE ,t2.pe_chg_1d ,t3.STOCK_NAME,t3.CHI_NAME\n  from SRCIFF.TB_FTS_DAILYINDEXCONSTITUENT t1 left\n  join SRCIFF.TB_FTS_DAILYPRICEINFO t2 on t2.acdate=t1.acdate\n  and t2.date=t1.date\n  and t2.code=t1.stock_code left\n  join srciff.TB_DW46SK1 t3 on t3.acdate=t1.acdate\n  and t3.stock_code=t1.stock_code\n  where t1.acdate= (select max(acdate)\n  from SRCIFF.TB_FTS_DAILYINDEXCONSTITUENT\n  where acdate <= current_date-7)\n  and t1.index_code='HSI'\n  order by t2.pe_chg_1d desc\n  limit 1",
    "tool_name": "worst_perform_stock_by_date",
    "parameters": {
      "index_code": "HSI",
      "acdate": "2023-01-15"
    },
    "tool_description": "查詢在xx日期，xxx指數表現最差的股票\n\nReturns:\n    str: The query result"
  },
  {
    "query_id": "f97136a6-cb72-453d-803d-50506e281061",
    "query": "What are the 3 Hong Kong banking stocks with the lowest P/B ratio on 2023-04-01?",
    "sql": "",
    "tool_name": "find_lowest_pb_hk_stock",
    "parameters": {
      "industry_code": null,
      "acdate": "2023-04-01",
      "number": "3"
    },
    "tool_description": "查詢xx日期，xx行業PB/ratio最低的n只香港股票\n\nReturns:\n    str: The query result"
  },
  {
    "query_id": "218a479d-7ca9-4282-a7b9-2992a8f16405",
    "query": "Which sectors have more than 10% weight in the HSI index on 2023-05-15?",
    "sql": "",
    "tool_name": "find_weight_by_date",
    "parameters": {
      "index_code": "HSI",
      "acdate": "2023-05-15",
      "weight": "10%"
    },
    "tool_description": "查詢xx日期，在xx指數中比重超過n%的板塊\n\nReturns:\n    str: The query result"
  },
  {
    "query_id": "58fecc70-bd49-4254-a2f3-e2352ae9e242",
    "query": "How much did the HSI index change between 2023-01-01 and 2023-03-31?",
    "sql": "select t1.CODE, sum(change) as agg_change\n  from SRCIFF.TB_FTS_DAILYINDEX t1\n  where t1.CODE='HSI'\n  and t1.ACDATE between '2023-01-01'\n  and '2023-03-31'\n  group by t1.CODE",
    "tool_name": "get_price_range_change",
    "parameters": {
      "start_date": "2023-01-01",
      "end_date": "2023-03-31",
      "index_code": "HSI"
    },
    "tool_description": "查詢xx時間段，xx指數的點數變化\n\nReturns:\n    str: The query result"
  },
  {
    "query_id": "ed9c1062-1132-48bb-8f59-51c0c4e49b2e",
    "query": "What was the return for Tencent stock between 2023-01-01 and 2023-06-30?",
    "sql": "select t1.ACDATE,t1.code,t1.HIGH,t1.LOW,t1.CLOSE\n  from SRCIFF.TB_FTS_DAILYPRICEINFO_US t1\n  where t1.acdate='2023-01-01 to 2023-06-30'\n  and t1.CODE='Tencent'",
    "tool_name": "get_highest_lowest_close_prices_by_date_stock_number",
    "parameters": {
      "stock_code": "Tencent",
      "acdate": "2023-01-01 to 2023-06-30"
    },
    "tool_description": "查詢在xx日期，美股xxxx股票號的最高價、最低價及收市價\n\nReturns:\n    str: The query result"
  },
  {
    "query_id": "2616822d-d93b-4016-aaf1-001dc3e83391",
    "query": "在2023-04-15這日，蘋果公司的股票最高價、最低價和收盤價是多少？",
    "sql": "select t1.ACDATE,t1.code,t1.HIGH,t1.LOW,t1.CLOSE\n  from SRCIFF.TB_FTS_DAILYPRICEINFO_US t1\n  where t1.acdate='2023-04-15'\n  and t1.CODE='AAPL'",
    "tool_name": "get_highest_lowest_close_prices_by_date_stock_number",
    "parameters": {
      "stock_code": "AAPL",
      "acdate": "2023-04-15"
    },
    "tool_description": "查詢在xx日期，美股xxxx股票號的最高價、最低價及收市價\n\nReturns:\n    str: The query result"
  },
  {
    "query_id": "383582ed-32b5-4ac3-98f2-bc79fbe0bab4",
    "query": "在2023-05-10這日，谷歌股票的技術形態如何？",
    "sql": "select distinct t1.ACDATE,t1.code,t1.PATTERN_ID,t1.PATTERN_NAME\n  from SRCIFF.TB_FTS_DAILYCHARTPATTERN t1\n  where t1.acdate='2023-05-10'\n  and t1.confirmed_date<='2023-05-10'\n  and t1.expiry_date>'2023-05-10'\n  and t1.CODE='GOOG'\n  and t1.pattern_ID in (5,6,7,8,13,14,26,27,30,31,32,34,35,36,41,42,43,44,45,46,50,51,60,61,62,63,70,71)",
    "tool_name": "get_technical_type_by_date_stock",
    "parameters": {
      "stock_code": "GOOG",
      "acdate": "2023-05-10"
    },
    "tool_description": "查詢在xx日期，某個xxxx股票號的技術形態\n\nReturns:\n    str: The query result"
  },
  {
    "query_id": "f153e652-19bf-43e8-b712-58a7774bc54b",
    "query": "在2023-06-01這日，中國銀行的預測市盈率是多少？",
    "sql": "select t1.DATE,t1.code,1/nullifzero(t1.earning_yld_estimate) as estimated_PE ,t3.STOCK_NAME,t3.CHI_NAME\n  from SRCIFF.TB_FTS_DAILYCOMPINFO t1 left\n  join srciff.TB_DW46SK1 t3 on t3.acdate=t1.acdate\n  and t3.stock_code=t1.code\n  where t1.acdate='2023-06-01'\n  and t3.CHI_NAME like '中国银行'",
    "tool_name": "get_stock_premium",
    "parameters": {
      "company_name": "中国银行",
      "acdate": "2023-06-01"
    },
    "tool_description": "查詢在xx日期，某個xx股票(公司名)的預測市盈率\n\nReturns:\n    str: The query result"
  },
  {
    "query_id": "9d50ae56-fd6a-42fc-b0de-51abed1ca546",
    "query": "在2023-03-15這日，恒生指數中收益率最高的5隻股票是哪些？",
    "sql": "select t1.DATE,t1.INDEX_CODE,t1.STOCK_CODE,t1.WEIGHT ,t2.EARNING_YLD_ESTIMATE ,t3.STOCK_NAME,t3.CHI_NAME\n  from SRCIFF.TB_FTS_DAILYINDEXCONSTITUENT t1 left\n  join SRCIFF.TB_FTS_DAILYCOMPINFO t2 on t2.acdate=t1.acdate\n  and t2.date=t1.date\n  and t2.code=t1.stock_code left\n  join srciff.TB_DW46SK1 t3 on t3.acdate=t1.acdate\n  and t3.stock_code=t1.stock_code\n  where t1.acdate='2023-03-15'\n  and t1.index_code='HK005'\n  order by t2.EARNING_YLD_ESTIMATE desc\n  limit '5'",
    "tool_name": "get_top_stocks_by_date_and_weight",
    "parameters": {
      "index_code": "HK005",
      "number": "5",
      "acdate": "2023-03-15"
    },
    "tool_description": "查詢在xx日期，xx指數成分股預測收益率最高的n只股票\n\nReturns:\n    str: The query result"
  },
  {
    "query_id": "f1165d0b-484a-4001-858c-a396aaefbc2f",
    "query": "截至2023-02-20，恒生指數中有多少銀行股，它們的總權重是多少？",
    "sql": "select t1.DATE,t1.INDEX_CODE ,count(t1.STOCK_CODE) as number_of_stock ,sum(t1.WEIGHT) as total_percent\n  from SRCIFF.TB_FTS_DAILYINDEXCONSTITUENT t1 left\n  join SRCIFF.TB_FTS_DAILYCOMPINFO t2 on t2.acdate=t1.acdate\n  and t2.date=t1.date\n  and t2.code=t1.stock_code\n  where t1.acdate='2023-02-20'\n  and t1.index_code='HSI'\n  and (t2.industry='BANKS'\n  or t2.industry='BANKS')\n  group by t1.DATE,t1.INDEX_CODE",
    "tool_name": "get_stock_holding_by_date_industry_ratio",
    "parameters": {
      "industry_code": "BANKS",
      "index_code": "HSI",
      "acdate": "2023-02-20"
    },
    "tool_description": "查詢在xx日期，xx行業在xx指數有多少隻股票，以及比重\n\nReturns:\n    str: The query result"
  },
  {
    "query_id": "84f8a13b-4203-4625-aa4c-7e1cf1ef7fb7",
    "query": "在2023-01-15這日，恒生指數中表現最差的股票是哪一隻？",
    "sql": "select t1.DATE,t1.INDEX_CODE ,t1.STOCK_CODE ,t2.pe_chg_1d ,t3.STOCK_NAME,t3.CHI_NAME\n  from SRCIFF.TB_FTS_DAILYINDEXCONSTITUENT t1 left\n  join SRCIFF.TB_FTS_DAILYPRICEINFO t2 on t2.acdate=t1.acdate\n  and t2.date=t1.date\n  and t2.code=t1.stock_code left\n  join srciff.TB_DW46SK1 t3 on t3.acdate=t1.acdate\n  and t3.stock_code=t1.stock_code\n  where t1.acdate= (select max(acdate)\n  from SRCIFF.TB_FTS_DAILYINDEXCONSTITUENT\n  where acdate <= current_date-7)\n  and t1.index_code='HSI'\n  order by t2.pe_chg_1d desc\n  limit 1",
    "tool_name": "worst_perform_stock_by_date",
    "parameters": {
      "index_code": "HSI",
      "acdate": "2023-01-15"
    },
    "tool_description": "查詢在xx日期，xxx指數表現最差的股票\n\nReturns:\n    str: The query result"
  },
  {
    "query_id": "0751df81-ba55-40c8-ac9d-84a0f92f85e2",
    "query": "在2023-04-01這日，市淨率最低的3隻香港銀行股是哪些？",
    "sql": "select t1.DATE,t1.CODE,t1.INDUSTRY ,t3.STOCK_NAME,t3.CHI_NAME ,t1.PB_RATIO\n  from SRCIFF.TB_FTS_DAILYCOMPINFO t1 left\n  join srciff.TB_DW46SK1 t3 on t3.acdate=t1.acdate\n  and t3.stock_code=t1.code\n  where t1.acdate='2023-04-01'\n  and t1.industry='null'\n  and t1.PB_RATIO is not null\n  order by t1.PB_RATIO asc\n  limit '3'",
    "tool_name": "find_lowest_pb_hk_stock",
    "parameters": {
      "industry_code": "null",
      "acdate": "2023-04-01",
      "number": "3"
    },
    "tool_description": "查詢xx日期，xx行業PB/ratio最低的n只香港股票\n\nReturns:\n    str: The query result"
  },
  {
    "query_id": "30194ce2-99be-424d-b32e-6e7e7e1b8ef6",
    "query": "在2023-05-15這日，恒生指數中權重超過10%的行業有哪些？",
    "sql": "With ind_con as (\n  select t1.ACDATE,t1.INDEX_CODE,t1.STOCK_CODE,t1.WEIGHT ,t2.INDUSTRY\n  from SRCIFF.TB_FTS_DAILYINDEXCONSTITUENT t1 left\n  join SRCIFF.TB_FTS_DAILYCOMPINFO t2 on t2.acdate=t1.acdate\n  and t2.date=t1.date\n  and t2.code=t1.stock_code\n  where t1.acdate='2023-05-15'\n  and t1.index_code='HSI' )\n  select t10.ACDATE,t10.INDUSTRY ,sum(t10.WEIGHT) as industry_weight\n  from ind_con t10\n  group by t10.ACDATE,t10.INDUSTRY\n  having sum(t10.WEIGHT)>'10'\n  order by sum(t10.WEIGHT) desc",
    "tool_name": "find_weight_by_date",
    "parameters": {
      "index_code": "HSI",
      "acdate": "2023-05-15",
      "weight": "10"
    },
    "tool_description": "查詢xx日期，在xx指數中比重超過n%的板塊\n\nReturns:\n    str: The query result"
  },
  {
    "query_id": "d6b3126c-d20b-4c09-87c9-3cb4bf810194",
    "query": "恒生指數在2023-01-01至2023-03-31期間的變化是多少？",
    "sql": "select t1.CODE, sum(change) as agg_change\n  from SRCIFF.TB_FTS_DAILYINDEX t1\n  where t1.CODE='恒生指數'\n  and t1.ACDATE between '2023-01-01'\n  and '2023-03-31'\n  group by t1.CODE",
    "tool_name": "get_price_range_change",
    "parameters": {
      "start_date": "2023-01-01",
      "end_date": "2023-03-31",
      "index_code": "恒生指數"
    },
    "tool_description": "查詢xx時間段，xx指數的點數變化\n\nReturns:\n    str: The query result"
  },
  {
    "query_id": "2a1c2274-7f7a-4866-856e-d215b039b24f",
    "query": "騰訊股票在2023-01-01至2023-06-30期間的回報率是多少？",
    "sql": "With background_data as (\n  select t1.ACDATE,t1.DATE,t1.CODE,t1.SECURITY_TYPE,t1.CLOSE,t1.PER_CHG_1D,t1.TURNOVER ,t1.COUNTER,t1.COMPANY_CODE,t1.CUR,t1.LIST_DATE,coalesce(t1.LIST_DATE,'1970-01-01') as LIST_DATE_DUMMY ,ln(PER_CHG_1D/100+1) as change_1D_log,CASE\n  when t1.CODE=t1.COUNTER then 1\n  else 2\n  end as stock_priority\n  from SRCIFF.TB_FTS_DAILYPRICEINFO t1\n  where acdate<='2023-06-30'\n  and acdate>='2023-01-01'\n  and t1.SECURITY_TYPE in ('STK','TRT','TRT_LIP','TRT_REI')-- can it be shown that it does not support this securities type\n  and (t1.counter='000001'\n  or t1.code='000001')\n  order by t1.ACDATE,t1.CODE), last_trading_date_data as(\n  select distinct t2.ACDATE,t2.COUNTER,t2.COMPANY_CODE,t2.CUR\n  from background_data t2\n  where t2.acdate=(select max(acdate)\n  from SRCIFF.TB_FTS_DAILYPRICEINFO\n  where acdate<='2023-06-30'\n  and acdate>'2023-06-30'::date-7)), stock_selected as(\n  select t5.*\n  from (select t4.*,rank() over (partition by t4.COMPANY_CODE,t4.COUNTER,t4.ACDATE,t4.DATE\n  order by t4.stock_priority) as ranking\n  from ( --- to make sure no reuse RIC is selected by taking out same company_code\n  select t3.*\n  from background_data t3 inner\n  join last_trading_date_data t4 on t4.company_code =t3.company_code\n  and t4.counter=t3.counter ) t4 ) t5\n  where t5.ranking=1)\n  select t7.CODE_ORI,exp (change_cum_log)-1 as percent_chg\n  from (select t6.COUNTER as CODE_ORI, sum(t6.change_1D_log) as change_cum_log\n  from stock_selected t6\n  group by t6.COUNTER) t7",
    "tool_name": "search_time_range_stock_report",
    "parameters": {
      "start_date": "2023-01-01",
      "end_date": "2023-06-30",
      "stock_code": "000001"
    },
    "tool_description": "查詢xx時間段，xx股票號的回報率\n\nReturns:\n    str: The query result"
  }
]